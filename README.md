# En

# Firebase Google Auth for .NET MAUI

## ‚úÖ Overview

This template uses **FirebaseAuthentication.net** and **WebAuthenticator**. It provides:

* Firebase Hosting (`redirect.html`)
* and the `AuthenticationMAUI` library, which integrates **Google Login** into a MAUI application.
  It also includes authentication via **Email in Firebase** and **Phone Number with SMS** (‚ö†Ô∏è this is a **paid feature**, available only on the **Blaze plan**) using **reCAPTCHA**.

For an example Firebase hosting setup, see the folder: `AuthenticationMAUI.FirebaseHostTemplate`.

---

## Step-by-step guide

### 1. Create a Firebase Project

1. Go to [Firebase Console](https://console.firebase.google.com)
2. Create a new project (e.g., `myapp-auth`)
3. Enable **Authentication > Sign-in method > Google** (for Google authentication)
4. Remember these values:

   * **Web API Key** (`Project Settings > General > Web API Key`)
   * **Auth domain** (`Authentication > Settings > Authorized Domains`) ‚Äî usually `project-id.firebaseapp.com`
5. Enable **Authentication > Sign-in method > Phone** (for SMS authentication)
6. Enable **Authentication > Sign-in method > Facebook** (for Facebook authentication)

---

### 2. Create OAuth 2.0 Client ID for Google authentication

1. Open [Google Cloud Console > API & Services > Credentials](https://console.cloud.google.com/apis/credentials)
2. Create (if not already created) an **OAuth 2.0 Client ID**:

   * Type: Web Application
   * Authorized redirect URIs: `https://project-id.firebaseapp.com/redirect.html`
3. Save the `client_id` (you can also find it in **Firebase Console > Authentication > Sign-in method > Google > Web SDK configuration > Web client ID**)

---

### 3. Create a Facebook App in Meta for Developers

1. [Create a new app in Meta for Developers](https://developers.facebook.com/apps/creation/)
2. Configure it for Facebook Login
3. In the created app, go to:
   **Dashboard > Set up "Facebook Login" product > Settings**
4. In **"Valid OAuth Redirect URIs"** add:
   `https://project-id.firebaseapp.com/redirect.html`
5. In **"Allowed Domains for the JavaScript SDK"** add the Firebase domain (from **Authentication > Settings > Authorized Domains**) ‚Äî usually `project-id.firebaseapp.com`

---

### 4. Create a reCAPTCHA key for Phone SMS authentication

1. Open [Google Cloud Console > Security > reCAPTCHA](https://console.cloud.google.com/security/recaptcha) and create a new key
2. **Application Type**: Web
3. **Add a domain**: your Firebase authorized domain (e.g. `project-id.firebaseapp.com`)
4. **Use challenge**: Yes ‚Üí Checkbox challenge
5. Create Key ‚Üí Save the **Site Key** (public) and **Secret Key** (private)
   *Site key will be used in `recaptcha.html`, Secret key will be stored in `FirebaseLoginData.SecretKey`*

**Alternative way:**

1. Open [reCAPTCHA create link](https://www.google.com/recaptcha/admin/create)
2. Add any label (name doesn‚Äôt matter)
3. reCAPTCHA type: "Checkbox challenge" (I am not a robot)
4. Add your Firebase domain (e.g., `project-id.firebaseapp.com`)
5. Select your Firebase project
6. Save site key and secret key

---

### 5. Setup Firebase Hosting

1. Install `firebase-tools` (requires [Node.js](https://nodejs.org/en/download/current)):

```bash
npm install -g firebase-tools
```

2. Login:

```bash
firebase login
```

3. Initialize hosting:

```bash
firebase init hosting
```

4. Answer questions:

```
1. Are you ready to proceed? Y
2. Please select an option:
   - Add Firebase to an existing Google Cloud Platform project
3. Select your Firebase project
4. What do you want to use as your public directory? public
5. Configure as a single-page app? N
6. Set up automatic builds and deploys with GitHub? N
```

---

### 6. Create `redirect.html` (for Google and Facebook authentication)

`public/redirect.html`:

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Redirecting...</title>
</head>
<body>
    <h1>REDIRECTING...</h1>
    <pre id="output"></pre>
    <script>      
        const fragment = window.location.hash.substring(1); 
        const params = new URLSearchParams(fragment);

        const idToken = params.get('id_token');
        const accessToken = params.get('access_token');

        const scheme = params.get('state') || 'myapp';

        if (idToken) {
            // Google
            window.location.href = scheme + '://auth?id_token=' + idToken;
        } else if (accessToken) {
            // Facebook
            window.location.href = scheme + '://auth?access_token=' + accessToken;
        } else {
            document.body.innerHTML = '<h2>Token not found</h2>';
        }
    </script>
</body>
</html>
```

---

### 7. Update `firebase.json`

```json
{
  "hosting": {
    "public": "public",
    "rewrites": [
      { "source": "/redirect.html", "destination": "/redirect.html" }
    ],
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ]
  }
}
```

---

### 8. Create `recaptcha.html` (for SMS reCAPTCHA verification)

`public/recaptcha.html`:

```html
<!DOCTYPE html>
<html>
<head>
    <title>reCAPTCHA</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script>
        function onSubmit(token) {
            window.location.href = "recaptcha://token?" + encodeURIComponent(token);
        }
    </script>
</head>
<body>
    <h3>reCAPTCHA Verification</h3>
    <form action="?" method="POST">
        <div class="g-recaptcha"
             data-sitekey="**__YOUR_SITE_KEY__**"
             data-callback="onSubmit">
        </div>
    </form>
</body>
</html>
```

Replace `__YOUR_SITE_KEY__` with the **public site key** from step 4.

---

### 9. Deploy

```bash
firebase deploy --only hosting
```

---

### 10. üîó Add into existing MAUI project

1. Clone repository:

```bash
git clone https://github.com/DenisLuba/AuthenticationMAUI.git
```

2. In Visual Studio:
   Solution ‚Üí `Add > Existing Project...` ‚Üí select `AuthenticationMAUI.csproj`
3. Then: Right-click on your MAUI project ‚Üí `Add > Project Reference...` ‚Üí check `AuthenticationMAUI`

---

### 11. üåê How to use `FirebaseLoginService`

1. Pass `FirebaseLoginData` via DI in `MauiProgram.cs`:

```csharp
builder.Services.AddSingleton<IUserStorageService, UserSecureStorageService>();
builder.Services.AddSingleton<ILoginService>(provider =>
{
    var userStorageService = provider.GetRequiredService<IUserStorageService>();
    return new FirebaseLoginService(
        new()
        {
            UserStorageService = userStorageService,
            ApiKey = GlobalValues.API_KEY, // Your Web API Key from the Firebase Console (Firebase Console > Project Settings > General > "Web API Key")
            AuthDomain = GlobalValues.AUTH_DOMAIN, // Usually this your-project-id.firebaseapp.com (Firebase Console > Authentication > Settings > "Authorized domains")
            GoogleClientId = GlobalValues.GOOGLE_CLIENT_ID, // Your Google Client ID (Firebase Console > Authentication > Sign-in method > Google > Web SDK configuration > "Web client ID")
            GoogleRedirectUri = GlobalValues.REDIRECT_URI, // Usually it is "https://your-project-id.firebaseapp.com/__/auth/handler ", but "__/auth/handler" is changed to "redirect.html ",
                                                           // to make it work "https://your-project-id.firebaseapp.com/redirect.html "
                                                           // (Google Cloud Console > APIs & Services > Credentials > Auth 2.0 Client IDs > Web client (auto created by Google Service) > Authorized redirect URIs)
            CallbackScheme = GlobalValues.CALLBACK_SCHEME, // A callback scheme for authentication via Google. For example, "myapp" for myapp:// (but you can also use myapp:// - this will be edited in the constructor)
            SecretKey = secretKey // Your Secret Key for reCAPTCHA from step 3.7
            SecretKey = GlobalValues.SECRET_KEY, // the secret key that Google issues when registering reCAPTCHA (used only on the server to verify the token)
            FacebookAppId = GlobalValues.FACEBOOK_APP_ID, // Your Facebook App ID (Facebook for Developers > My Apps > [Your App] > Settings > Basic > App ID)
            FacebookRedirectUri = GlobalValues.REDIRECT_URI // Usually it is "https://your-project-id.firebaseapp.com/__/auth/handler ", but "__/auth/handler" is changed to "redirect.html ",
                                                            // to make it work "https://your-project-id.firebaseapp.com/redirect.html "
                                                            // (Meta for Developers > Panel > Set up the "Authentication and Data request from users using Facebook Login > settings > Valid redirect URIs for OAuth" scenario)
        });
});
```

2. For Android, add `intent-filter` in `MainActivity.cs`:

```csharp
[Activity(NoHistory = true, LaunchMode = LaunchMode.SingleTop, Exported = true)]
[IntentFilter(
    new[] { Android.Content.Intent.ActionView },
    Categories = new[] { Android.Content.Intent.CategoryDefault, Android.Content.Intent.CategoryBrowsable },
    DataScheme = CALLBACK_SCHEME)]
public class WebAuthenticationCallbackActivity : Microsoft.Maui.Authentication.WebAuthenticatorCallbackActivity
{
    private const string CALLBACK_SCHEME = "myapp"; // Must match the callback scheme of CallbackScheme (passed to FirebaseLoginService)
}
```

3. For iOS, add to `Info.plist`:

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>myapp</string>
    </array>
  </dict>
</array>
```

Replace `myapp` with the same callback scheme you pass to `FirebaseLoginService`.

---

üéâ Done!
Now you can reuse this template across multiple MAUI projects with Firebase Hosting! üîÅ

---

# Fr (Traduit par AI)

# Authentification Google Firebase pour .NET MAUI

## ‚úÖ Aper√ßu

Ce template utilise **FirebaseAuthentication.net** et **WebAuthenticator**. Il fournit :

* Firebase Hosting (`redirect.html`)
* et la librairie `AuthenticationMAUI`, qui int√®gre la connexion **Google Login** dans une application MAUI.
  Il inclut √©galement l‚Äôauthentification via **Email dans Firebase** et **Num√©ro de t√©l√©phone avec SMS** (‚ö†Ô∏è c‚Äôest une **fonctionnalit√© payante**, disponible uniquement avec le plan **Blaze**) avec **reCAPTCHA**.

Pour un exemple d‚Äôh√©bergement Firebase, voir le dossier : `AuthenticationMAUI.FirebaseHostTemplate`.

---

## Guide √©tape par √©tape

### 1. Cr√©er un projet Firebase

1. Aller sur [Firebase Console](https://console.firebase.google.com)
2. Cr√©er un projet (par ex. `myapp-auth`)
3. Activer **Authentication > Sign-in method > Google** (pour l‚Äôauthentification Google)
4. Noter les valeurs suivantes :

   * **Web API Key** (`Project Settings > General > Web API Key`)
   * **Auth domain** (`Authentication > Settings > Authorized Domains`) ‚Äî en g√©n√©ral `project-id.firebaseapp.com`
5. Activer **Authentication > Sign-in method > Phone** (pour l‚Äôauthentification par SMS)
6. Activer **Authentication > Sign-in method > Facebook** (pour l‚Äôauthentification Facebook)

---

### 2. Cr√©er un OAuth 2.0 Client ID pour Google

1. Ouvrir [Google Cloud Console > API & Services > Credentials](https://console.cloud.google.com/apis/credentials)
2. Cr√©er (si pas d√©j√† cr√©√©) un **OAuth 2.0 Client ID** :

   * Type: Web Application
   * Authorized redirect URIs: `https://project-id.firebaseapp.com/redirect.html`
3. Enregistrer le `client_id` (disponible aussi dans **Firebase Console > Authentication > Sign-in method > Google > Web SDK configuration > Web client ID**)

---

### 3. Cr√©er une application Facebook dans Meta for Developers

1. [Cr√©er une nouvelle app dans Meta for Developers](https://developers.facebook.com/apps/creation/)
2. Configurer l‚Äôapp pour Facebook Login
3. Dans l‚Äôapp cr√©√©e, aller dans :
   **Dashboard > Set up "Facebook Login" product > Settings**
4. Dans **"Valid OAuth Redirect URIs"**, ajouter :
   `https://project-id.firebaseapp.com/redirect.html`
5. Dans **"Allowed Domains for the JavaScript SDK"**, ajouter le domaine Firebase (depuis **Authentication > Settings > Authorized Domains**) ‚Äî en g√©n√©ral `project-id.firebaseapp.com`

---

### 4. Cr√©er une cl√© reCAPTCHA pour l‚Äôauthentification SMS

1. Ouvrir [Google Cloud Console > Security > reCAPTCHA](https://console.cloud.google.com/security/recaptcha) et cr√©er une cl√©
2. **Application Type** : Web
3. **Add a domain** : domaine autoris√© Firebase (ex. `project-id.firebaseapp.com`)
4. **Use challenge** : Oui ‚Üí Checkbox challenge
5. Cr√©er la cl√© ‚Üí Enregistrer la **Site Key** (publique) et la **Secret Key** (priv√©e)
   *La Site Key sera utilis√©e dans `recaptcha.html`, la Secret Key sera stock√©e dans `FirebaseLoginData.SecretKey`*

**Alternative** :

1. Ouvrir [ce lien](https://www.google.com/recaptcha/admin/create)
2. Donner un label (n‚Äôimporte lequel)
3. reCAPTCHA type : "Checkbox challenge" (I am not a robot)
4. Ajouter le domaine Firebase (ex. `project-id.firebaseapp.com`)
5. S√©lectionner le projet
6. Enregistrer la site key et la secret key

---

### 5. Configurer Firebase Hosting

1. Installer `firebase-tools` (n√©cessite [Node.js](https://nodejs.org/en/download/current)) :

```bash
npm install -g firebase-tools
```

2. Se connecter :

```bash
firebase login
```

3. Initialiser l‚Äôh√©bergement :

```bash
firebase init hosting
```

4. R√©pondre aux questions :

```
1. Are you ready to proceed? Y
2. Please select an option:
   - Add Firebase to an existing Google Cloud Platform project
3. Select your Firebase project
4. What do you want to use as your public directory? public
5. Configure as a single-page app? N
6. Set up automatic builds and deploys with GitHub? N
```

---

### 6. Cr√©er `redirect.html` (pour Google et Facebook)

`public/redirect.html` :

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Redirection...</title>
</head>
<body>
    <h1>REDIRECTION...</h1>
    <pre id="output"></pre>
    <script>      
        const fragment = window.location.hash.substring(1); // dans l‚ÄôURL apr√®s '#'
        const params = new URLSearchParams(fragment);

        const idToken = params.get('id_token');
        const accessToken = params.get('access_token');

        const scheme = params.get('state') || 'myapp';

        if (idToken) {
            // Connexion Google
            window.location.href = scheme + '://auth?id_token=' + idToken;
        } else if (accessToken) {
            // Connexion Facebook
            window.location.href = scheme + '://auth?access_token=' + accessToken;
        } else {
            document.body.innerHTML = '<h2>Aucun token trouv√©</h2>';
        }
    </script>
</body>
</html>
```

---

### 7. Modifier `firebase.json`

```json
{
  "hosting": {
    "public": "public",
    "rewrites": [
      { "source": "/redirect.html", "destination": "/redirect.html" }
    ],
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ]
  }
}
```

---

### 8. Cr√©er `recaptcha.html` (pour SMS reCAPTCHA)

`public/recaptcha.html` :

```html
<!DOCTYPE html>
<html>
<head>
    <title>reCAPTCHA</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script>
        function onSubmit(token) {
            // On redirige le token vers l‚Äôapplication MAUI
            window.location.href = "recaptcha://token?" + encodeURIComponent(token);
        }
    </script>
</head>
<body>
    <h3>V√©rification reCAPTCHA</h3>
    <form action="?" method="POST">
        <div class="g-recaptcha"
             data-sitekey="**__YOUR_SITE_KEY__**"
             data-callback="onSubmit">
        </div>
    </form>
</body>
</html>
```

Remplacer `__YOUR_SITE_KEY__` par la **cl√© publique** du reCAPTCHA.

---

### 9. D√©ploiement

```bash
firebase deploy --only hosting
```

---

### 10. üîó Ajouter dans un projet MAUI existant

1. Cloner le d√©p√¥t :

```bash
git clone https://github.com/DenisLuba/AuthenticationMAUI.git
```

2. Dans Visual Studio :
   Solution ‚Üí `Add > Existing Project...` ‚Üí s√©lectionner `AuthenticationMAUI.csproj`
3. Puis : clic droit sur votre projet MAUI ‚Üí `Add > Project Reference...` ‚Üí cocher `AuthenticationMAUI`

---

### 11. üåê Utiliser `FirebaseLoginService`

1. Passer `FirebaseLoginData` via DI dans `MauiProgram.cs` :

```csharp
builder.Services.AddSingleton<IUserStorageService, UserSecureStorageService>();
builder.Services.AddSingleton<ILoginService>(provider =>
{
    var userStorageService = provider.GetRequiredService<IUserStorageService>();
    return new FirebaseLoginService(
        new()
        {
            UserStorageService = userStorageService,
            ApiKey = GlobalValues.API_KEY, // Votre cl√© API Web depuis la console Firebase (Firebase Console > Param√®tres du projet > G√©n√©ral > "Web API Key")
            AuthDomain = GlobalValues.AUTH_DOMAIN, // G√©n√©ralement votre-project-id.firebaseapp.com (Firebase Console > Authentication > Param√®tres > "Domaines autoris√©s")
            GoogleClientId = GlobalValues.GOOGLE_CLIENT_ID, // Votre identifiant client Google (Firebase Console > Authentication > M√©thode de connexion > Google > Configuration Web SDK > "Web client ID")
            GoogleRedirectUri = GlobalValues.REDIRECT_URI, // G√©n√©ralement "https://your-project-id.firebaseapp.com/__/auth/handler", mais ici on le change en "redirect.html"
                                                   // Cela devient donc "https://your-project-id.firebaseapp.com/redirect.html"
                                                   // (Google Cloud Console > APIs & Services > Credentials > OAuth 2.0 Client IDs > Client Web > URIs de redirection autoris√©s)
            CallbackScheme = GlobalValues.CALLBACK_SCHEME, // Le sch√©ma de rappel utilis√© pour l‚Äôauthentification Google. Par exemple, "myapp" pour myapp://
            SecretKey = GlobalValues.SECRET_KEY, // Votre cl√© secr√®te pour reCAPTCHA √† partir de l'√©tape 3.7
            FacebookAppId = GlobalValues.FACEBOOK_APP_ID, // ID d‚Äôapplication Facebook (Facebook for Developers > My Apps > [Your App] > Settings > Basic > App ID)
            FacebookRedirectUri = GlobalValues.REDIRECT_URI // G√©n√©ralement "https://your-project-id.firebaseapp.com/__/auth/handler", mais ici on le change en "redirect.html"
                                                   // Cela devient donc "https://your-project-id.firebaseapp.com/redirect.html"
                                                   // (Meta for Developers > Panel > Set up the "Authentication and Data request from users using Facebook Login > settings > Valid redirect URIs for OAuth" scenario)

        });
});
```

2. Pour Android, ajouter un `intent-filter` dans `MainActivity.cs` :

```csharp
[Activity(NoHistory = true, LaunchMode = LaunchMode.SingleTop, Exported = true)]
[IntentFilter(
    new[] { Android.Content.Intent.ActionView },
    Categories = new[] { Android.Content.Intent.CategoryDefault, Android.Content.Intent.CategoryBrowsable },
    DataScheme = CALLBACK_SCHEME)]
public class WebAuthenticationCallbackActivity : Microsoft.Maui.Authentication.WebAuthenticatorCallbackActivity
{
    private const string CALLBACK_SCHEME = "myapp"; // doit correspondre √† CallbackScheme pass√© au service
}
```

3. Pour iOS, ajouter dans `Info.plist` :

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>myapp</string>
    </array>
  </dict>
</array>
```

Remplacer `myapp` par le sch√©ma que vous avez configur√© dans `FirebaseLoginService`.

---

üéâ Fini !
Ce template peut maintenant √™tre r√©utilis√© dans plusieurs projets MAUI avec Firebase Hosting üîÅ

---

# Ru

# Firebase Google Auth for .NET MAUI

## ‚úÖ –û–±–∑–æ—Ä

–≠—Ç–æ—Ç —à–∞–±–ª–æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç FirebaseAuthentication.net –∏ WebAuthenticator. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

* Firebase Hosting (`redirect.html`)
* –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `AuthenticationMAUI`, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–∫–ª—é—á–∞–µ—Ç Google Login –≤ MAUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –¢–∞–∫–∂–µ –≤ –Ω–µ–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Email –≤ Firebase –∏ —á–µ—Ä–µ–∑ –°–ú–° –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–≠–¢–û –ü–õ–ê–¢–ù–ê–Ø –£–°–õ–£–ì–ê, –¥–æ—Å—Ç—É–ø–Ω–∞—è –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ç–∞—Ä–∏—Ñ–µ Blaze) —Å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ–º reCAPTCHA.

–ü—Ä–∏–º–µ—Ä —Ö–æ—Å—Ç–∏–Ω–≥–∞ –Ω–∞ Firebase —Å–º–æ—Ç—Ä–∏ –≤ –ø–∞–ø–∫–µ "AuthenticationMAUI.FirebaseHostTemplate"
---

## –ü–æ—à–∞–≥–æ–≤–æ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Firebase-–ø—Ä–æ–µ–∫—Ç–∞

1. –ü–µ—Ä–µ–π–¥–∏ –≤ [Firebase](https://console.firebase.google.com)
2. –°–æ–∑–¥–∞–π –ø—Ä–æ–µ–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `myapp-auth`)
3. –í–∫–ª—é—á–∏ Authentication > Sign-in method > Google (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google)
4. –ó–∞–ø–æ–º–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏—è:
   * Web API Key (**Project Settings > General > Web API Key**) (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google)
   * Auth domain (**Authentication > Settings > Authorized Domains**) ‚Äî –æ–±—ã—á–Ω–æ `project-id.firebaseapp.com`
5. –í–∫–ª—é—á–∏ Authentication > Sign-in method > Phone (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ CMC)
6. –í–∫–ª—é—á–∏ Authentication > Sign-in method > Facebook (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Facebook)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ OAuth 2.0 Client ID –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google

1. –û—Ç–∫—Ä–æ–π [Google Cloud Console > API & Services > Credentials](https://console.cloud.google.com/apis/credentials)
2. –°–æ–∑–¥–∞–π, –µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω,¬†`OAuth 2.0 Client ID`:

   * Type: Web Application
   * Authorized redirect URIs: `https://project-id.firebaseapp.com/redirect.html` (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Ñ–∞–π–ª—É redirect –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ Firebase)
3. –ó–∞–ø–æ–º–Ω–∏ `client_id` (—Ç–∞–º –∂–µ –∏–ª–∏ –≤ Firebase Console > Authentication > Sign-in method > Google > Web SDK configuration > Web client ID)

### 3. –°–æ–∑–¥–∞–Ω–∏–µ Facebook App –≤ Meta for Developers

1. [–°–æ–∑–¥–∞–π –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Meta for Developers](https://developers.facebook.com/apps/creation/)
2. –ù–∞—Å—Ç—Ä–æ–π –µ–≥–æ –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ facebook
3. –í —Å–æ–∑–¥–∞–Ω–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–π–¥–∏ –≤ **–ü–∞–Ω–µ–ª—å > –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∑–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ "–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Facebook" > –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
4. –í **"–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ URI –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è OAuth"** –¥–æ–±–∞–≤—å—Ç–µ URL —Ç–∏–ø–∞ `https://project-id.firebaseapp.com/redirect.html` (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Ñ–∞–π–ª—É redirect –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ Firebase)
5. –í **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è SDK JavaScript** –¥–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –∏–∑ Firebase (**Authentication > Settings > Authorized Domains**) ‚Äî –æ–±—ã—á–Ω–æ `project-id.firebaseapp.com`

### 4. –°–æ–∑–¥–∞–π –∫–ª—é—á reCAPTCHA –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –°–ú–° —Å reCAPTCHA

1. –û—Ç–∫—Ä–æ–π [Google Cloud Console > Security > reCAPTCHA](https://console.cloud.google.com/security/recaptcha) –∏ —Å–æ–∑–¥–∞–π –∫–ª—é—á
2. Application Type - Web
3. Add a domain - (**Firebase Project > Authentication > Settings > Authorized Domains**) ‚Äî –æ–±—ã—á–Ω–æ `project-id.firebaseapp.com `
4. Next Step > Will you use challenges - –î–∞ > Checkbox challenge
5. Create Key > Save the Site Key ([reCAPTCHA](https://console.cloud.google.com/security/recaptcha) > reCAPTCHA Keys > ID of yours key) –∏ Secret Key ([reCAPTCHA](https://console.cloud.google.com/security/recaptcha) > reCAPTCHA Keys > Key details > (Continue with the instructions) Use legacy key)

–ò–õ–ò

1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ [—Å—Å—ã–ª–∫—É](https://www.google.com/recaptcha/admin/create)
2. –î–æ–±–∞–≤—å—Ç–µ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —è—Ä–ª—ã–∫ (–Ω–µ–≤–∞–∂–Ω–æ, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ)
3. reCAPTCHA type: –° –ø–æ–º–æ—â—å—é –∑–∞–¥–∞–Ω–∏–π (v2) - –§–ª–∞–∂–æ–∫ "I am not a robot" 
4. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –∏–∑ Firebase (Authentication > Settings > Authorized Domains) ‚Äî –æ–±—ã—á–Ω–æ project-id.firebaseapp.com
5. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—Ä–æ–µ–∫—Ç
6. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
7. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á —Å–∞–π—Ç–∞ –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

### 5. –ù–∞—Å—Ç—Ä–æ–π firebase hosting

1. –£—Å—Ç–∞–Ω–æ–≤–∏, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, `firebase-tools` —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª [View ‚Üí Terminal], –Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–≤–Ω–∞—á–∞–ª–µ —Å–∫–∞—á–∞–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏ [Node.js](https://nodejs.org/en/download/current)):

```bash
npm install -g firebase-tools
```

2. –í–æ–π–¥–∏:

```bash
firebase login
```

3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π hosting (–∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ –±–µ—Ä–∏ –∏–∑ Firebase):

```bash
firebase init hosting
```

4. –û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç firebase:
```bash
1. Are you ready to proceed? Y
2. Please select an option:
- Add Firebase to an existring Google Cloud Platform project
3. Select the Google Cloud Platform project you would like to add Firebase: –≤–∞—à –ø—Ä–æ–µ–∫—Ç
4. What do you want to use your public directory? public
5. Configure as a single-page app(rewrite allurls to /index.html)? N
6. Set up authomatic builds and deploys with GitHub? N
```

### 6. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª redirect.html (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google –∏ —á–µ—Ä–µ–∑ Facebook)

`public/redirect.html`:

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Redirecting...</title>
</head>
<body>
    <h1>REDIRECTING...</h1>
    <pre id="output"></pre>
    <script>      
        const fragment = window.location.hash.substring(1); // –≤ url –ø–æ—Å–ª–µ '#'
        const params = new URLSearchParams(fragment);

        const idToken = params.get('id_token');
        const accessToken = params.get('access_token');

        const scheme = params.get('state') || 'myapp';

        if (idToken) {
            // Google
            window.location.href = scheme + '://auth?id_token=' + idToken;
        } else if (accessToken) {
            // Facebook
            window.location.href = scheme + '://auth?access_token=' + accessToken;
        } else {
            document.body.innerHTML = '<h2>Token not found</h2>';
        }
    </script>
</body>
</html>
```

### 7. –ò–∑–º–µ–Ω–∏ —Ñ–∞–π–ª firebase.json (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google –∏ —á–µ—Ä–µ–∑ Facebook)

```json
{
  "hosting": {
    "public": "public",
    "rewrites": [
      { "source": "/redirect.html", "destination": "/redirect.html" }
    ],
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ]
  }
}
```

### 8. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª recaptcha.html (–¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –°–ú–° —Å reCAPTCHA)

`public/redirect.html`:

```html
<!DOCTYPE html>
<html>
<head>
    <title>reCAPTCHA</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script>
        function onSubmit(token) {
            window.location.href = "recaptcha://token?" + encodeURIComponent(token);
        }
    </script>
</head>
<body>
    <h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ reCAPTCHA</h3>
    <form action="?" method="POST">
        <div class="g-recaptcha"
             data-sitekey="**__YOUR_SITE_KEY__**"
             data-callback="onSubmit">
        </div>
    </form>
</body>
</html>
```
–ó–∞–º–µ–Ω–∏ "**__YOUR_SITE_KEY__**" –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (site key) –∏–∑ —à–∞–≥–∞ 3.7.

### 9. –î–µ–ø–ª–æ–π

```bash
firebase deploy --only hosting
```

---

### 10. üîó –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π MAUI –ø—Ä–æ–µ–∫—Ç

1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/DenisLuba/AuthenticationMAUI.git
```

2. –í Visual Studio: –ü–ö–ú –Ω–∞ —Ä–µ—à–µ–Ω–∏–∏ ‚Üí `Add > Existing Project...` ‚Üí –≤—ã–±–µ—Ä–∏ `AuthenticationMAUI.csproj`
3. –ó–∞—Ç–µ–º: –ü–ö–ú –Ω–∞ –ø—Ä–æ–µ–∫—Ç–µ MAUI ‚Üí `Add > Project Reference...` ‚Üí –æ—Ç–º–µ—Ç—å `AuthenticationMAUI`

---

### 11. üåê –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FirebaseLoginService

1. –ü–µ—Ä–µ–¥–∞–π FirebaseLoginData —á–µ—Ä–µ–∑ DI –≤ MauiProgram.cs:

```csharp
builder.Services.AddSingleton<IUserStorageService, UserSecureStorageService>();
builder.Services.AddSingleton<ILoginService>(provider =>
{
    var userStorageService = provider.GetRequiredService<IUserStorageService>();
            return new FirebaseLoginService(
                new()
                {
                    UserStorageService = userStorageService,
                    ApiKey = GlobalValues.API_KEY, // –í–∞—à Web API Key –∏–∑ Firebase Console (Firebase Console > Project Settings > General > "Web API Key")
                    AuthDomain = GlobalValues.AUTH_DOMAIN, // –û–±—ã—á–Ω–æ —ç—Ç–æ your-project-id.firebaseapp.com (Firebase Console > Authentication > Settings > "Authorized domains")
                    GoogleClientId = GlobalValues.GOOGLE_CLIENT_ID, // –í–∞—à Google Client ID (Firebase Console > Authentication > Sign-in method > Google > Web SDK configuration > "Web client ID")
                    GoogleRedirectUri = GlobalValues.REDIRECT_URI, // –û–±—ã—á–Ω–æ –≤ Google Cloud Console –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —ç—Ç–æ "https://your-project-id.firebaseapp.com/__/auth/handler",
                                                                   // –Ω–æ "__/auth/handler" –º–µ–Ω—è–µ–º –Ω–∞ "redirect.html",
                                                                   // —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏–ª–æ—Å—å "https://your-project-id.firebaseapp.com/redirect.html"
                                                                   // (Google Cloud Console > APIs & Services > Credentials > Auth 2.0 Client IDs > Web client (auto created by Google Service) > Authorized redirect URIs)
                    CallbackScheme = GlobalValues.CALLBACK_SCHEME, // –°—Ö–µ–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google.
                                                                   // –ù–∞–ø—Ä–∏–º–µ—Ä, "myapp" –¥–ª—è myapp:// (–Ω–æ –º–æ–∂–Ω–æ –∏ myapp:// - —ç—Ç–æ –±—É–¥–µ—Ç –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∫–ª–∞—Å—Å–∞ FirebaseLoginService).
                                                                   // –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "your_project_id" - –∏–º—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
                    SecretKey = GlobalValues.SECRET_KEY, // —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–µ—Ç Google –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ reCAPTCHA (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞).
                    FacebookAppId = GlobalValues.FACEBOOK_APP_ID, // –í–∞—à Facebook App ID (Facebook for Developers > My Apps > [Your App] > Settings > Basic > App ID)
                    FacebookRedirectUri = GlobalValues.REDIRECT_URI // –û–±—ã—á–Ω–æ –≤ Google Cloud Console –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —ç—Ç–æ "https://your-project-id.firebaseapp.com/__/auth/handler",
                                                                    // –Ω–æ "__/auth/handler" –º–µ–Ω—è–µ–º –Ω–∞ "redirect.html",
                                                                    // —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏–ª–æ—Å—å "https://your-project-id.firebaseapp.com/redirect.html"
                                                                    // (Meta for Developers > –ü–∞–Ω–µ–ª—å > –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∑–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ "–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Facebook" > –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ > –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ URI –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è OAuth)
                });
});
```

2. –î–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google –¥–æ–±–∞–≤—å intent-filter –¥–ª—è Android –≤ `MainActivity.cs`, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∏–∂–µ –∫–ª–∞—Å—Å–∞ MainActivity –≤ —Ç–æ–º –∂–µ —Ñ–∞–π–ª–µ:

```csharp
[Activity(NoHistory = true, LaunchMode = LaunchMode.SingleTop, Exported = true)]
[IntentFilter(
    [Android.Content.Intent.ActionView],
    Categories = [Android.Content.Intent.CategoryDefault, Android.Content.Intent.CategoryBrowsable],
    DataScheme = CALLBACK_SCHEME)]
public class WebAuthenticationCallbackActivity : Microsoft.Maui.Authentication.WebAuthenticatorCallbackActivity
{
    private const string CALLBACK_SCHEME = "myapp"; // –î–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å–æ —Å—Ö–µ–º–æ–π –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ CallbackScheme (–ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–π –≤ FirebaseLoginService)
}
```

3. –î–æ–±–∞–≤—å –≤ Info.plist (–¥–ª—è iOS):

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>myapp</string>
    </array>
  </dict>
</array>
```

–í–º–µ—Å—Ç–æ myapp –≤—Å—Ç–∞–≤—å —Ç—É —Å—Ö–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑–∞–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å—Ö–µ–º—ã –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ CallbackScheme (–ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–π –≤ FirebaseLoginService)

---

–£—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å–æ—Ç–Ω–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ MAUI —Å Firebase Hosting!üîÅ

–û—Ç–ª–∏—á–Ω–æ üöÄ
–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–≤–µ–¥—É README –Ω–∞ **–∫–∏—Ç–∞–π—Å–∫–∏–π (ÁÆÄ‰Ωì‰∏≠Êñá)**, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç.
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ —Ç–æ–∂–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã, –Ω–æ –≤—Å–µ –ø—É—Ç–∏ –≤–Ω—É—Ç—Ä–∏ **Google Console / Firebase / Meta** —è –æ—Å—Ç–∞–≤–ª—è—é –Ω–∞ **Ëã±Êñá**, –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ.

---

# Zh-CN ÔºàAIÁøªËØëÔºâ

# Firebase Google Ë∫´‰ªΩÈ™åËØÅ for .NET MAUI

## ‚úÖ Ê¶ÇËø∞

ËØ•Ê®°Êùø‰ΩøÁî® **FirebaseAuthentication.net** Âíå **WebAuthenticator**„ÄÇÂÆÉÊèê‰æõÔºö

* Firebase Hosting (`redirect.html`)
* `AuthenticationMAUI` Â∫ìÔºåÁî®‰∫éÂú® MAUI Â∫îÁî®‰∏≠Êé•ÂÖ• **Google ÁôªÂΩï**„ÄÇ
  ÂêåÊó∂ËøòÂÆûÁé∞‰∫Ü **Firebase ÈÇÆÁÆ±ÁôªÂΩï** Âíå **ÊâãÊú∫Âè∑Áü≠‰ø°ÁôªÂΩï**Ôºà‚ö†Ô∏è Áü≠‰ø°ÁôªÂΩïÊòØ **‰ªòË¥πÂäüËÉΩ**ÔºåÁõÆÂâçÂè™Âú® **Blaze Â•óÈ§ê**‰∏≠ÂèØÁî®ÔºâÔºåÂπ∂ÈÖçÂêà **reCAPTCHA**„ÄÇ

Firebase Hosting Á§∫‰æãËßÅÊñá‰ª∂Â§π `AuthenticationMAUI.FirebaseHostTemplate`„ÄÇ

---

## Ê≠•È™§

### 1. ÂàõÂª∫ Firebase È°πÁõÆ

1. ÊâìÂºÄ [Firebase Console](https://console.firebase.google.com)
2. ÂàõÂª∫‰∏Ä‰∏™È°πÁõÆ (‰æãÂ¶Ç `myapp-auth`)
3. ÂêØÁî® **Authentication > Sign-in method > Google**ÔºàGoogle ÁôªÂΩïÔºâ
4. ËÆ∞ÂΩï‰ª•‰∏ãÂÄºÔºö

   * **Web API Key** (`Project Settings > General > Web API Key`)
   * **Auth domain** (`Authentication > Settings > Authorized Domains`) ‚Äî ÈÄöÂ∏∏ÊòØ `project-id.firebaseapp.com`
5. ÂêØÁî® **Authentication > Sign-in method > Phone**ÔºàÊâãÊú∫Âè∑Áü≠‰ø°ÁôªÂΩïÔºâ
6. ÂêØÁî® **Authentication > Sign-in method > Facebook**ÔºàFacebook ÁôªÂΩïÔºâ

---

### 2. ÂàõÂª∫ Google OAuth 2.0 Client ID

1. ÊâìÂºÄ [Google Cloud Console > API & Services > Credentials](https://console.cloud.google.com/apis/credentials)
2. Â¶ÇÊûúËøòÊ≤°ÊúâÔºåÂàõÂª∫‰∏Ä‰∏™ **OAuth 2.0 Client ID**Ôºö

   * Á±ªÂûã: Web Application
   * Authorized redirect URIs: `https://project-id.firebaseapp.com/redirect.html`
3. ‰øùÂ≠ò `client_id`Ôºà‰πüÂèØÂú® Firebase Console > Authentication > Sign-in method > Google > Web SDK configuration > Web client ID ÊâæÂà∞Ôºâ

---

### 3. ÂàõÂª∫ Facebook Â∫îÁî® (Meta for Developers)

1. [Âú® Meta for Developers ÂàõÂª∫‰∏Ä‰∏™Êñ∞Â∫îÁî®](https://developers.facebook.com/apps/creation/)
2. ÈÖçÁΩÆÂ∫îÁî®‰ª•ÊîØÊåÅ Facebook ÁôªÂΩï
3. Âú®Â∫îÁî®‰∏≠ËøõÂÖ•Ôºö
   **Dashboard > Set up "Facebook Login" product > Settings**
4. Âú® **"Valid OAuth Redirect URIs"** ‰∏≠Ê∑ªÂä†Ôºö
   `https://project-id.firebaseapp.com/redirect.html`
5. Âú® **"Allowed Domains for the JavaScript SDK"** ‰∏≠Ê∑ªÂä† Firebase ÂüüÂêç (Firebase Console > Authentication > Settings > Authorized Domains) ‚Äî ÈÄöÂ∏∏ÊòØ `project-id.firebaseapp.com`

---

### 4. ÂàõÂª∫ reCAPTCHA ÂØÜÈí•ÔºàÁî®‰∫éÁü≠‰ø°ËÆ§ËØÅÔºâ

1. ÊâìÂºÄ [Google Cloud Console > Security > reCAPTCHA](https://console.cloud.google.com/security/recaptcha)ÔºåÂàõÂª∫‰∏Ä‰∏™ÂØÜÈí•
2. **Application Type**: Web
3. **Add a domain**: Ê∑ªÂä† Firebase ÊéàÊùÉÂüüÂêç (‰æãÂ¶Ç `project-id.firebaseapp.com`)
4. **Use challenge**: ÊòØ ‚Üí Checkbox challenge
5. ÂàõÂª∫ÂØÜÈí•ÂêéÔºå‰øùÂ≠ò **Site Key**ÔºàÂÖ¨Èí•Ôºâ Âíå **Secret Key**ÔºàÁßÅÈí•Ôºâ
   *Site Key Áî®‰∫é `recaptcha.html`ÔºåSecret Key Â≠òÊîæÂú® `FirebaseLoginData.SecretKey`*

**ÊàñËÄÖ**Ôºö

1. ÊâìÂºÄ [reCAPTCHA ÂàõÂª∫È°µÈù¢](https://www.google.com/recaptcha/admin/create)
2. ËæìÂÖ•‰∏Ä‰∏™Ê†áÁ≠æÔºàÈöèÊÑèÔºâ
3. reCAPTCHA Á±ªÂûã: "Checkbox challenge (v2)"
4. Ê∑ªÂä† Firebase ÂüüÂêç (‰æãÂ¶Ç `project-id.firebaseapp.com`)
5. ÈÄâÊã©È°πÁõÆ
6. ‰øùÂ≠ò **Site Key** Âíå **Secret Key**

---

### 5. ÈÖçÁΩÆ Firebase Hosting

1. ÂÆâË£Ö `firebase-tools` (ÈúÄË¶ÅÂÖàÂÆâË£Ö [Node.js](https://nodejs.org/en/download/current))Ôºö

```bash
npm install -g firebase-tools
```

2. ÁôªÂΩï FirebaseÔºö

```bash
firebase login
```

3. ÂàùÂßãÂåñ HostingÔºö

```bash
firebase init hosting
```

4. ÂõûÁ≠î Firebase ÁöÑÈóÆÈ¢òÔºö

```
1. Are you ready to proceed? Y
2. Please select an option:
   - Add Firebase to an existing Google Cloud Platform project
3. Select your Firebase project
4. What do you want to use as your public directory? public
5. Configure as a single-page app? N
6. Set up automatic builds and deploys with GitHub? N
```

---

### 6. ÂàõÂª∫ `redirect.html` (Áî®‰∫é Google Âíå Facebook ÁôªÂΩï)

`public/redirect.html`:

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Ê≠£Âú®ÈáçÂÆöÂêë...</title>
</head>
<body>
    <h1>REDIRECTING...</h1>
    <pre id="output"></pre>
    <script>      
        const fragment = window.location.hash.substring(1); // URL ‰∏≠ '#' ÂêéÈù¢ÁöÑÈÉ®ÂàÜ
        const params = new URLSearchParams(fragment);

        const idToken = params.get('id_token');
        const accessToken = params.get('access_token');

        const scheme = params.get('state') || 'myapp';

        if (idToken) {
            // Google ÁôªÂΩï
            window.location.href = scheme + '://auth?id_token=' + idToken;
        } else if (accessToken) {
            // Facebook ÁôªÂΩï
            window.location.href = scheme + '://auth?access_token=' + accessToken;
        } else {
            document.body.innerHTML = '<h2>Êú™ÊâæÂà∞ Token</h2>';
        }
    </script>
</body>
</html>
```

---

### 7. ‰øÆÊîπ `firebase.json`

```json
{
  "hosting": {
    "public": "public",
    "rewrites": [
      { "source": "/redirect.html", "destination": "/redirect.html" }
    ],
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ]
  }
}
```

---

### 8. ÂàõÂª∫ `recaptcha.html` (Áî®‰∫éÁü≠‰ø°È™åËØÅ)

`public/recaptcha.html`:

```html
<!DOCTYPE html>
<html>
<head>
    <title>reCAPTCHA</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script>
        function onSubmit(token) {
            // Â∞Ü reCAPTCHA token ËøîÂõûÂà∞ MAUI Â∫îÁî®
            window.location.href = "recaptcha://token?" + encodeURIComponent(token);
        }
    </script>
</head>
<body>
    <h3>reCAPTCHA È™åËØÅ</h3>
    <form action="?" method="POST">
        <div class="g-recaptcha"
             data-sitekey="**__YOUR_SITE_KEY__**"
             data-callback="onSubmit">
        </div>
    </form>
</body>
</html>
```

ËØ∑Â∞Ü `__YOUR_SITE_KEY__` ÊõøÊç¢‰∏∫Ê≠•È™§ 4 ‰∏≠ÁîüÊàêÁöÑ **Site Key**ÔºàÂÖ¨Èí•Ôºâ„ÄÇ

---

### 9. ÈÉ®ÁΩ≤

```bash
firebase deploy --only hosting
```

---

### 10. üîó Âú®Áé∞Êúâ MAUI È°πÁõÆ‰∏≠‰ΩøÁî®

1. ÂÖãÈöÜ‰ªìÂ∫ìÔºö

```bash
git clone https://github.com/DenisLuba/AuthenticationMAUI.git
```

2. Âú® Visual Studio ‰∏≠Ôºö
   Âè≥ÈîÆËß£ÂÜ≥ÊñπÊ°à ‚Üí `Add > Existing Project...` ‚Üí ÈÄâÊã© `AuthenticationMAUI.csproj`
3. ÁÑ∂ÂêéÔºöÂè≥ÈîÆ MAUI È°πÁõÆ ‚Üí `Add > Project Reference...` ‚Üí ÂãæÈÄâ `AuthenticationMAUI`

---

### 11. üåê ‰ΩøÁî® `FirebaseLoginService`

1. Âú® `MauiProgram.cs` ‰∏≠ÈÄöËøá‰æùËµñÊ≥®ÂÖ•‰º†ÈÄí `FirebaseLoginData`Ôºö

```csharp
builder.Services.AddSingleton<IUserStorageService, UserSecureStorageService>();
builder.Services.AddSingleton<ILoginService>(provider =>
{
    var userStorageService = provider.GetRequiredService<IUserStorageService>();
    return new FirebaseLoginService(
        new()
        {
            UserStorageService = userStorageService,
            ApiKey = apiKey, // Êù•Ëá™ Firebase ÊéßÂà∂Âè∞ÁöÑ Web API KeyÔºàFirebase Console > Project Settings > General > "Web API Key"Ôºâ
            AuthDomain = authDomain, // ÈÄöÂ∏∏‰∏∫ your-project-id.firebaseapp.comÔºàFirebase Console > Authentication > Settings > "Authorized domains"Ôºâ
            GoogleClientId = googleClientId, // Google ÂÆ¢Êà∑Á´Ø IDÔºàFirebase Console > Authentication > Sign-in method > Google > Web SDK configuration > "Web client ID"Ôºâ
            GoogleRedirectUri = googleRedirectUri, // ÈÄöÂ∏∏‰∏∫ "https://your-project-id.firebaseapp.com/__/auth/handler"Ôºå‰ΩÜÊàë‰ª¨Â∞Ü "__/auth/handler" ÊõøÊç¢‰∏∫ "redirect.html"ÔºåÂç≥
                                                   // "https://your-project-id.firebaseapp.com/redirect.html"
                                                   // ÔºàGoogle Cloud Console > APIs & Services > Credentials > Auth 2.0 Client IDs > Web client > Authorized redirect URIsÔºâ
            CallbackScheme = callbackScheme, // Google ÁôªÂΩïÂõûË∞ÉÁöÑ scheme„ÄÇ‰æãÂ¶Ç "myapp" ÂØπÂ∫î myapp://ÔºàÂèØ‰ª•Ëá™ÂÆö‰πâÔºâ
            SecretKey = secretKey // Ê≠•È™§3.7‰∏≠ÁöÑreCAPTCHAÂØÜÈí•

            FacebookAppId = GlobalValues.FACEBOOK_APP_ID, // Facebook Â∫îÁî® ID (Facebook for Developers > My Apps > [Your App] > Settings > Basic > App ID)

            FacebookRedirectUri = GlobalValues.REDIRECT_URI // ÈÄöÂ∏∏‰∏∫ "https://your-project-id.firebaseapp.com/__/auth/handler"Ôºå‰ΩÜÊàë‰ª¨Â∞Ü "__/auth/handler" ÊõøÊç¢‰∏∫ "redirect.html"ÔºåÂç≥
                                                   // "https://your-project-id.firebaseapp.com/redirect.html"
                                                   // // (Meta for Developers > Panel > Set up the "Authentication and Data request from users using Facebook Login > settings > Valid redirect URIs for OAuth" scenario)
        });
});
```

2. Android ‰∏≠ÔºåÂú® `MainActivity.cs` Ê∑ªÂä† `intent-filter`Ôºö

```csharp
[Activity(NoHistory = true, LaunchMode = LaunchMode.SingleTop, Exported = true)]
[IntentFilter(
    new[] { Android.Content.Intent.ActionView },
    Categories = new[] { Android.Content.Intent.CategoryDefault, Android.Content.Intent.CategoryBrowsable },
    DataScheme = CALLBACK_SCHEME)]
public class WebAuthenticationCallbackActivity : Microsoft.Maui.Authentication.WebAuthenticatorCallbackActivity
{
    private const string CALLBACK_SCHEME = "myapp"; // ÂøÖÈ°ª‰∏é FirebaseLoginService ‰∏≠‰º†ÂÖ•ÁöÑ CallbackScheme ‰øùÊåÅ‰∏ÄËá¥
}
```

3. iOS ‰∏≠ÔºåÂú® `Info.plist` Ê∑ªÂä†Ôºö

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>myapp</string>
    </array>
  </dict>
</array>
```

Â∞Ü `myapp` ÊõøÊç¢‰∏∫‰Ω†Âú® `FirebaseLoginService` ‰∏≠ÈÖçÁΩÆÁöÑ CallbackScheme„ÄÇ

---

üéâ ÂÆåÊàêÔºÅ
Áé∞Âú®ËØ•Ê®°ÊùøÂèØ‰ª•Âú®Â§ö‰∏™ MAUI È°πÁõÆ‰∏≠ÈáçÂ§ç‰ΩøÁî®ÔºåÂπ∂ÊîØÊåÅ Firebase Hosting üîÅ

---
